var Q=Object.defineProperty;var X=(t,a,s)=>a in t?Q(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s;var $=(t,a,s)=>X(t,typeof a!="symbol"?a+"":a,s);import{u as Z,_ as ee,a as te,b as ae,c as re}from"./Ban9b-RX.js";import{f as se,g as k,h as P,i as ne,j as oe,k as T,r as E,l as G,m as H,n as le,p as U,q as D,s as ie,v as ue,x as R,o as W,w as f,y as de,z as ce,A as fe,B as p,C as me,D as pe,E as ye,F as ve,G as he,H as we,a as L,b as w,I as _e,d as be,J as ge}from"./ug1oA7G6.js";function Se(t){return t.validate&&t.__isYupSchema__}function Ee(t){return t.inner!==void 0}function Ie(t){return"schema"in t&&typeof t.coercer=="function"&&typeof t.validator=="function"&&typeof t.refiner=="function"}function Fe(t){return t.validateAsync!==void 0&&t.id!==void 0}function qe(t){return t.isJoi===!0}function je(t){return"~standard"in t}async function xe(t,a){var r;const s=await a["~standard"].validate(t);return s.issues?{errors:((r=s.issues)==null?void 0:r.map(i=>{var c;return{name:((c=i.path)==null?void 0:c.map(d=>typeof d=="object"?d.key:d).join("."))||"",message:i.message}}))||[],result:null}:{errors:null,result:s.value}}async function Be(t,a){try{return{errors:null,result:await a.validate(t,{abortEarly:!1})}}catch(s){if(Ee(s))return{errors:s.inner.map(i=>({name:i.path??"",message:i.message})),result:null};throw s}}async function Ae(t,a){const[s,r]=a.validate(t);return s?{errors:s.failures().map(c=>({message:c.message,name:c.path.join(".")})),result:null}:{errors:null,result:r}}async function Ce(t,a){try{return{errors:null,result:await a.validateAsync(t,{abortEarly:!1})}}catch(s){if(qe(s))return{errors:s.details.map(i=>({name:i.path.join("."),message:i.message})),result:null};throw s}}function Oe(t,a){if(je(a))return xe(t,a);if(Fe(a))return Ce(t,a);if(Se(a))return Be(t,a);if(Ie(a))return Ae(t,a);throw new Error("Form validation failed: Unsupported form schema")}class V extends Error{constructor(s,r,i){super("Form validation exception");$(this,"formId");$(this,"errors");$(this,"children");this.formId=s,this.errors=r,this.children=i,Object.setPrototypeOf(this,V.prototype)}}const Ue={base:""},Ve={__name:"Form",props:{id:{type:[String,Number],required:!1},schema:{type:null,required:!1},state:{type:Object,required:!0},validate:{type:Function,required:!1},validateOn:{type:Array,required:!1,default(){return["input","blur","change"]}},disabled:{type:Boolean,required:!1},validateOnInputDelay:{type:Number,required:!1,default:300},transform:{type:Boolean,required:!1,default:!0},attach:{type:Boolean,required:!1,default:!0},loadingAuto:{type:Boolean,required:!1,default:!0},class:{type:null,required:!1},onSubmit:{type:Function,required:!1}},emits:["submit","error"],setup(t,{expose:a,emit:s}){const r=t,i=s,c=se(),d=k(()=>{var e;return P({extend:P(Ue),...((e=c.ui)==null?void 0:e.form)||{}})}),l=r.id??ne(),_=Z(`form-${l}`),m=r.attach&&oe(T,void 0);U(T,_);const I=E(new Map);G(async()=>{_.on(async e=>{var n;e.type==="attach"?I.value.set(e.formId,{validate:e.validate}):e.type==="detach"?I.value.delete(e.formId):(n=r.validateOn)!=null&&n.includes(e.type)&&!S.value&&(e.type!=="input"?await F({name:e.name,silent:!0,nested:!1}):(e.eager||J.has(e.name))&&await F({name:e.name,silent:!0,nested:!1})),e.type==="blur"&&J.add(e.name),(e.type==="change"||e.type==="input"||e.type==="blur"||e.type==="focus")&&y.add(e.name),(e.type==="change"||e.type==="input")&&g.add(e.name)})}),H(()=>{_.reset()}),G(async()=>{m&&(await le(),m.emit({type:"attach",validate:F,formId:l}))}),H(()=>{m&&m.emit({type:"detach",formId:l})});const o=E([]);U("form-errors",o);const b=E({});U(pe,b);const g=new Set,y=new Set,J=new Set;function N(e){return e.map(n=>{var u;return{...n,id:n!=null&&n.name?(u=b.value[n.name])==null?void 0:u.id:void 0}})}const K=E(null);async function Y(){let e=r.validate?await r.validate(r.state)??[]:[];if(r.schema){const{errors:n,result:u}=await Oe(r.state,r.schema);n?e=e.concat(n):K.value=u}return N(e)}async function F(e={silent:!1,nested:!0,transform:!1}){const n=e.name&&!Array.isArray(e.name)?[e.name]:e.name,u=!n&&e.nested?Array.from(I.value.values()).map(({validate:h})=>h(e).then(()=>{}).catch(q=>{if(!(q instanceof V))throw q;return q})):[];if(n){const h=o.value.filter(j=>!n.some(x=>{var A,C,O;const B=(C=(A=b.value)==null?void 0:A[x])==null?void 0:C.pattern;return x===j.name||B&&((O=j.name)==null?void 0:O.match(B))})),q=(await Y()).filter(j=>n.some(x=>{var A,C,O;const B=(C=(A=b.value)==null?void 0:A[x])==null?void 0:C.pattern;return x===j.name||B&&((O=j.name)==null?void 0:O.match(B))}));o.value=h.concat(q)}else o.value=await Y();const v=(await Promise.all(u)).filter(h=>h!==void 0);if(o.value.length+v.length>0){if(e.silent)return!1;throw new V(l,o.value,v)}return e.transform&&Object.assign(r.state,K.value),r.state}const S=E(!1);U(ie,D(S));async function z(e){var u;S.value=r.loadingAuto&&!0;const n=e;try{n.data=await F({nested:!0,transform:r.transform}),await((u=r.onSubmit)==null?void 0:u.call(r,n)),g.clear()}catch(v){if(!(v instanceof V))throw v;const h={...n,errors:v.errors,children:v.children};i("error",h)}finally{S.value=!1}}const M=k(()=>r.disabled||S.value);return U(ue,k(()=>({disabled:M.value,validateOnInputDelay:r.validateOnInputDelay}))),a({validate:F,errors:o,setErrors(e,n){n?o.value=o.value.filter(u=>u.name!==n).concat(N(e)):o.value=N(e)},async submit(){await z(new Event("submit"))},getErrors(e){return e?o.value.filter(n=>n.name===e):o.value},clear(e){e?o.value=o.value.filter(n=>n.name!==e):o.value=[]},disabled:M,loading:S,dirty:k(()=>!!g.size),dirtyFields:D(g),blurredFields:D(J),touchedFields:D(y)}),(e,n)=>(W(),R(me(p(m)?"div":"form"),{id:p(l),class:ce(d.value({class:r.class})),onSubmit:fe(z,["prevent"])},{default:f(()=>[de(e.$slots,"default",{errors:o.value})]),_:3},40,["id","class"]))}},$e={dir:"rtl",class:"flex justify-center items-center h-screen"},Ne=ye({__name:"index",setup(t){const a=ve({email:void 0,password:void 0}),s=E(!1),r=he(),i=we();async function c(){s.value=!0;const d=await ge("https://easymed-dashboard.radmanvahed.workers.dev/api/auth/login",{method:"post",body:a});s.value=!1,r.add({title:d.message,color:d.success?"success":"error"}),d.success&&i.push("/dashboard")}return(d,l)=>{const _=re,m=ae,I=Ve,o=_e,b=te,g=ee;return W(),R(g,null,{default:f(()=>[L("div",$e,[w(b,{class:"w-full md:w-1/3 h-fit"},{header:f(()=>l[3]||(l[3]=[L("h1",{class:"text-lg text-center"},"ورود به پنل گزارشات ایزی مد",-1)])),footer:f(()=>[w(o,{loading:p(s),onClick:l[2]||(l[2]=y=>c()),block:""},{default:f(()=>l[4]||(l[4]=[be(" ورود ")])),_:1,__:[4]},8,["loading"])]),default:f(()=>[w(I,{state:p(a),class:"space-y-4"},{default:f(()=>[w(m,{label:"ایمیل",name:"email"},{default:f(()=>[w(_,{class:"w-full",modelValue:p(a).email,"onUpdate:modelValue":l[0]||(l[0]=y=>p(a).email=y),required:""},null,8,["modelValue"])]),_:1}),w(m,{label:"کلمه عبور",name:"password"},{default:f(()=>[w(_,{class:"w-full",modelValue:p(a).password,"onUpdate:modelValue":l[1]||(l[1]=y=>p(a).password=y),type:"password",required:""},null,8,["modelValue"])]),_:1})]),_:1},8,["state"])]),_:1})])]),_:1})}}});export{Ne as default};
