import{o as x,s as m,_ as y,a as V,b as $,c as B,d as v,u as C}from"./CBWhV8CL.js";import{e as S,f as z,g as F,h as j,r as A,i as L,j as R,w as l,o as q,a as p,b as o,k as t,l as N,m as T}from"./BJS-XC4N.js";const D={dir:"rtl",class:"flex justify-center items-center min-h-screen"},E=S({__name:"index",setup(I){const i=z(),u=F(),f=j(),_=T(),h=x({username:m().min(3,"نام کاربری باید حداقل ۳ کاراکتر باشد."),password:m().min(6,"کلمه عبور باید حداقل ۶ کاراکتر باشد.")}),n=A({username:"",password:""}),r=L(!1);async function g(w){var a,c;r.value=!0;try{const e={method:"POST",baseURL:_.public.apiBaseUrl,body:n,headers:i.token?{Authorization:`Bearer ${i.token}`}:{}},s=await C("/auth/login",e);s!=null&&s.success&&s.token?(i.setLoginData(s.token,s.user??{role:"user"}),u.add({title:"ورود موفق",description:s.message||"شما با موفقیت وارد شدید.",color:"success",icon:"i-heroicons-check-circle"}),await f.push("/dashboard")):u.add({title:"خطا",description:(s==null?void 0:s.message)||"خطا در ورود — لطفاً دوباره تلاش کنید.",color:"error"})}catch(e){((e==null?void 0:e.status)??((a=e==null?void 0:e.response)==null?void 0:a.status))===401||u.add({title:"خطای شبکه یا سرور",description:((c=e==null?void 0:e.data)==null?void 0:c.message)||(e==null?void 0:e.message)||"خطایی رخ داد.",color:"error"})}finally{r.value=!1}}return(w,a)=>{const c=v,e=B,s=N,b=$,k=V,U=y;return q(),R(U,null,{default:l(()=>[p("div",D,[o(k,{class:"w-full max-w-sm"},{header:l(()=>[...a[2]||(a[2]=[p("h1",{class:"text-xl font-bold text-center"},"ورود به پنل ایزی مد",-1)])]),default:l(()=>[o(b,{schema:t(h),state:t(n),class:"space-y-4",onSubmit:g},{default:l(()=>[o(e,{class:"w-full",label:"نام کاربری",name:"username",required:""},{default:l(()=>[o(c,{class:"w-full",modelValue:t(n).username,"onUpdate:modelValue":a[0]||(a[0]=d=>t(n).username=d),placeholder:"نام کاربری خود را وارد کنید",icon:"i-heroicons-user",size:"lg",autocomplete:"username"},null,8,["modelValue"])]),_:1}),o(e,{class:"w-full",label:"کلمه عبور",name:"password",required:""},{default:l(()=>[o(c,{class:"w-full",modelValue:t(n).password,"onUpdate:modelValue":a[1]||(a[1]=d=>t(n).password=d),type:"password",placeholder:"کلمه عبور خود را وارد کنید",icon:"i-heroicons-lock-closed",size:"lg",autocomplete:"current-password"},null,8,["modelValue"])]),_:1}),o(s,{type:"submit",loading:t(r),block:"",label:"ورود",size:"lg"},null,8,["loading"])]),_:1},8,["schema","state"])]),_:1})])]),_:1})}}});export{E as default};
